<div class="container">
    <h1 class="text-center">Rewards List</h1>
    <div class="col-md-2 rewards-filter">
        <h4>Filters</h4>
        <%= link_to 'Reset filters', request.params.merge(filters: {}) %>
        <% Reward.status.values.each do |status| %>
            <hr>
            <%= apply_status_filter(status) %>
        <% end %>
    </div>
    <div class="col-md-7 rewards">

        <div class="text-center">
            <%= paginate @rewards, class: 'page-item' %>
        </div>

        <table class="table table-hover">
            <thead>
                <th><%= sortable 'id' %></th>
                <th><%= sortable 'status' %></th>
                <%  if current_user %>
                    <th>User email</th>
                <% end %>
            </thead>
            <tbody>
                <% @rewards.each do |rw| %>
                    <tr>
                        <td>
                            <%= rw.id %>
                        </td>
                        <td>
                            <%= format(rw.status) %>
                        </td>
                        <% if current_user %>
                            <td>
                                <%= rw.user.email %>
                            </td>
                        <% end %>
                    </tr>
                    <% end %>
            </tbody>
        </table>
    </div>
    <div class="col-md-3">
        <h4>User section</h4>

        <% unless current_user %>
            <div class="panel-body">
                <%= form_for(User.new, as: 'user', url: session_path('user'), html: { role: 'form' }) do |f| %>
                <div class="form-group">
                    <%= f.label :email %>
                    <%= f.email_field :email, autofocus: true, class: 'form-control' %>
                </div>
                <div class="form-group">
                    <%= f.label :password %>
                    <%= f.password_field :password, autocomplete: 'off', class: 'form-control' %>
                </div>
                <%= f.submit  t('.sign_in', default: 'Sign in'), class: 'btn btn-primary' %>
                <% end %>
            </div>
        <% else %>
            <%= link_to 'Log Out', destroy_user_session_path, method: :delete %>
        <% end %>
        <br>
        <%= link_to 'Sign Up', new_user_registration_path %>
        <br>
        <%= link_to 'Edit your profile', user_registration_path, method: :patch %>
    </div>
</div>
